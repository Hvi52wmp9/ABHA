import streamlit as st
import pandas as pd

st.set_page_config(page_title="ููุชุฑุฉ ุงูุฃุณูู ุงูุฃูุฑูููุฉ", layout="centered")
st.title("๐ ููุชุฑุฉ ุงูุฃุณูู ุงูุฃูุฑูููุฉ")
st.markdown("ูุฑุญุจุงู ุจู ูู ููุตุฉ ุงูููุงุชุฑ ุงููููุฉ ูุงูุดุฑุนูุฉ ููุฃุณูู ุงูุฃูุฑูููุฉ.")

# --- ุงูููุชุฑุฉ ุงูุฃุณุงุณูุฉ ---
st.sidebar.header("ุงูููุชุฑุฉ ุงูุฃุณุงุณูุฉ")
sector = st.sidebar.selectbox("ุงุฎุชุฑ ุงููุทุงุน", [
    "ุงููู", "ุงูุชูููููุฌูุง", "ุงูุฑุนุงูุฉ ุงูุตุญูุฉ", "ุงููุงููุฉ", "ุงูุทุงูุฉ", "ุงูุตูุงุนุฉ",
    "ุงูุงุชุตุงูุงุช", "ุงููุฑุงูู ุงูุนุงูุฉ", "ุงูุนูุงุฑุงุช", "ุงูุณูุน ุงูุงุณุชููุงููุฉ", "ุงูุฎุฏูุงุช ุงูุงุณุชููุงููุฉ"
])
price_range = st.sidebar.slider("ูุทุงู ุงูุณุนุฑ (ุฏููุงุฑ)", 0, 2000, (50, 300))

# --- ุงููุคุดุฑุงุช ุงููููุฉ ---
st.sidebar.header("ุงููุคุดุฑุงุช ุงููููุฉ")
rsi_enabled = st.sidebar.checkbox("RSI (ูุคุดุฑ ุงูููุฉ ุงููุณุจูุฉ)")
macd_enabled = st.sidebar.checkbox("MACD (ุชูุงุฑุจ ูุชุจุงุนุฏ ุงููุชูุณุทุงุช)")
sma_enabled = st.sidebar.checkbox("SMA (ุงููุชูุณุท ุงููุชุญุฑู ุงูุจุณูุท)")
ema_enabled = st.sidebar.checkbox("EMA (ุงููุชูุณุท ุงููุชุญุฑู ุงูุฃุณู)")
bb_enabled = st.sidebar.checkbox("Bollinger Bands (ุงูุงูุญุฑุงู ุงููุนูุงุฑู)")

# --- ุงูููุชุฑุฉ ุงูุดุฑุนูุฉ ---
st.sidebar.header("ุงูููุชุฑุฉ ุงูุดุฑุนูุฉ")
sharia_filter = st.sidebar.checkbox("ุชูุนูู ุงูููุชุฑุฉ ุงูุดุฑุนูุฉ")
if sharia_filter:
    st.sidebar.info("โ ุณูุชู ุงุณุชุจุนุงุฏ ุงูุดุฑูุงุช ุฐุงุช ุงูุฃูุดุทุฉ ุงูุฑุจููุฉ ุฃู ูุณุจ ุฏููู ูุฑุชูุนุฉ.")

# --- ุฒุฑ ุชูููุฐ ุงูููุชุฑุฉ ---
if st.sidebar.button("ุชูููุฐ ุงูููุชุฑุฉ"):
    st.success("โ ุชู ุชุทุจูู ุงูููุงุชุฑ ุจูุฌุงุญ")
    st.write("### ุชูุงุตูู ุงูููุชุฑุฉ:")
    st.write(f"๐น ุงููุทุงุน ุงููุฎุชุงุฑ: `{sector}`")
    st.write(f"๐น ูุทุงู ุงูุณุนุฑ: ูู `{price_range[0]}` ุฅูู `{price_range[1]}` ุฏููุงุฑ")

    indicators = []
    if rsi_enabled: indicators.append("RSI")
    if macd_enabled: indicators.append("MACD")
    if sma_enabled: indicators.append("SMA")
    if ema_enabled: indicators.append("EMA")
    if bb_enabled: indicators.append("Bollinger Bands")
    st.write("๐น ุงููุคุดุฑุงุช ุงููููุฉ ุงูููุนููุฉ:")
    st.write(indicators if indicators else "ูุง ุชูุฌุฏ ูุคุดุฑุงุช ููุนููุฉ")
    if sharia_filter:
        st.write("๐น ุงูููุชุฑุฉ ุงูุดุฑุนูุฉ: ููุนููุฉ โ")

    # --- ุจูุงูุงุช ุชุฌุฑูุจูุฉ ูุคูุชุฉ ---
    sample_data = {
        "ุงูุฑูุฒ": ["AAPL", "MSFT", "GOOGL"],
        "ุงููุทุงุน": ["ุงูุชูููููุฌูุง", "ุงูุชูููููุฌูุง", "ุงูุงุชุตุงูุงุช"],
        "ุงูุณุนุฑ": [175.3, 310.2, 135.6],
        "RSI": [55, 48, 62],
        "MACD": [1.2, -0.5, 0.8],
        "ุดุฑุนูุ": ["โ", "โ", "โ"]
    }
    df = pd.DataFrame(sample_data)

    # --- ุนุฑุถ ุงููุชุงุฆุฌ ---
    st.markdown("---")
    st.subheader("๐ ุงูุฃุณูู ุงูุชู ุชุฌุงูุฒุช ุงูููุชุฑุฉ")
    st.dataframe(df)

    # --- ุฒุฑ ุชุญููู ุงููุชุงุฆุฌ ---
    st.download_button(
        label="๐ฅ ุชุญููู ุงููุชุงุฆุฌ ุจุตูุบุฉ CSV",
        data=df.to_csv(index=False).encode('utf-8'),
        file_name='filtered_stocks.csv',
        mime='text/csv'
    )

# --- ููุงุญุธุฉ ุฎุชุงููุฉ ---
st.markdown("---")
st.caption("๐ ูุฐู ูุณุฎุฉ ุฃูููุฉ ูุงุจูุฉ ููุชูุณุน ูุณุชูุจูุงู ูุฑุจุท ูุจุงุดุฑ ุจุจูุงูุงุช ุงูุณูู ุงูุฃูุฑููู ุนุจุฑ API.")
